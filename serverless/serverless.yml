service: serverless
frameworkVersion: '2'
useDotenv: false
custom:
  dotenv:
    exclude:
      - CLOUDFLARE_ACCOUNT_ID
      - CLOUDFLARE_ZONE_ID
      - CLOUDFLARE_AUTH_KEY
      - CLOUDFLARE_AUTH_EMAIL

provider:
  name: cloudflare
  config:
    accountId: ${env:CLOUDFLARE_ACCOUNT_ID}
    zoneId: ${env:CLOUDFLARE_ZONE_ID}

plugins:
  - serverless-dotenv-plugin
  - serverless-cloudflare-workers

functions:
  v4_1_api:
    name: v4_1_api
    script: src/actions/avatar
    webpack: webpack.config
    events:
      - http:
          url: dicebear-avatars.com/4.1/api/*
          method: GET
      - http:
          url: dicebear-avatars.com/4.1/v2/*
          method: GET
  v4_1_stats:
    name: v4_1_stats
    script: src/actions/stats
    webpack: webpack.config
    events:
      - http:
          url: dicebear-avatars.com/4.1/stats.json
          method: GET
